<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="manifest" href="/site.webmanifest"/><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#000000"/><meta name="msapplication-TileColor" content="#2b5797"/><meta name="theme-color" content="#ffffff"/><meta name="google-site-verification" content="oliS-hJhDV0wCNFfVhfAC0igKcuVEDSj6XCaqtuSwQA"/><script src="/js/mode.js"></script><title>Cmajor is Awesome | How I Made A Game</title><meta name="description" content="Cmajor is a domain specific language for audio programming, and it is spectacular"/><script id="giscus-script" src="https://giscus.app/client.js" data-repo="levimcgomes/levimcgomes.github.io" data-repo-id="R_kgDOH_rqaA" data-category="Blog Comments" data-category-id="DIC_kwDOH_rqaM4CVNZX" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="1" data-input-position="top" data-theme="dark-dimmed" data-lang="en" crossorigin="anonymous" async=""></script><meta name="next-head-count" content="14"/><link rel="preload" href="https://cdn.statically.io/gh/levi-gomes/levi-gomes.github.io/gh-pages/_next/static/css/197a660f770936bf.css" as="style"/><link rel="stylesheet" href="https://cdn.statically.io/gh/levi-gomes/levi-gomes.github.io/gh-pages/_next/static/css/197a660f770936bf.css" data-n-g=""/><link rel="preload" href="https://cdn.statically.io/gh/levi-gomes/levi-gomes.github.io/gh-pages/_next/static/css/28cea9dbbca02b72.css" as="style"/><link rel="stylesheet" href="https://cdn.statically.io/gh/levi-gomes/levi-gomes.github.io/gh-pages/_next/static/css/28cea9dbbca02b72.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="https://cdn.statically.io/gh/levi-gomes/levi-gomes.github.io/gh-pages/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="https://cdn.statically.io/gh/levi-gomes/levi-gomes.github.io/gh-pages/_next/static/chunks/webpack-74ef5a84c939c88d.js" defer=""></script><script src="https://cdn.statically.io/gh/levi-gomes/levi-gomes.github.io/gh-pages/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="https://cdn.statically.io/gh/levi-gomes/levi-gomes.github.io/gh-pages/_next/static/chunks/main-18053c3f67c4d467.js" defer=""></script><script src="https://cdn.statically.io/gh/levi-gomes/levi-gomes.github.io/gh-pages/_next/static/chunks/pages/_app-4862d28c0e85fdc0.js" defer=""></script><script src="https://cdn.statically.io/gh/levi-gomes/levi-gomes.github.io/gh-pages/_next/static/chunks/175675d1-370b5e3106085c09.js" defer=""></script><script src="https://cdn.statically.io/gh/levi-gomes/levi-gomes.github.io/gh-pages/_next/static/chunks/b5f2ed29-b0b5179426d9fdcf.js" defer=""></script><script src="https://cdn.statically.io/gh/levi-gomes/levi-gomes.github.io/gh-pages/_next/static/chunks/pages/blog/%5Bslug%5D-c43d00c2c6b941b0.js" defer=""></script><script src="https://cdn.statically.io/gh/levi-gomes/levi-gomes.github.io/gh-pages/_next/static/yQWaVv-dGMBSVfk7VEAwv/_buildManifest.js" defer=""></script><script src="https://cdn.statically.io/gh/levi-gomes/levi-gomes.github.io/gh-pages/_next/static/yQWaVv-dGMBSVfk7VEAwv/_ssgManifest.js" defer=""></script></head><body><div id="__next"><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-4XQ38SS8N1"></script><script src="/js/gtag.js"></script><div class="header-container"><h2 href="/">How I Made A Game</h2><div><a href="/#about">About</a><a href="/archive">All Posts</a><a href="/">Home</a><button class="theme-toggle"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke="#FFFFFF" style="cursor:pointer;transform:rotate(40deg)"><mask id="myMask2"><rect x="0" y="0" width="100%" height="100%" fill="white"></rect><circle style="cx:12px;cy:4px" r="9" fill="black"></circle></mask><circle cx="12" cy="12" style="r:9px" fill="white" mask="url(#myMask2)"></circle><g stroke="white" style="opacity:0"><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></g></svg></button></div></div><main class="page"><div align="right"><a class="btn-back"><span>Go Back</span></a></div><div class="post-page"><h1 class="post-title">Cmajor is Awesome</h1><img class="post-full-image" src="../images/posts/audio/cmajor-awesome_cover.png" alt=""/><div class="post-date">8/9/2023</div><div class="post-tags"><div class="post-tag">audio</div><div class="post-tag">cmajor</div></div><div class="post-body"><div><p>Recently, I've started learning about audio programming for a side project (more on this in the next post!). I started by trying to learn JUCE, but I found it awkward to work with, especially since C++ isn't my strongest language. It introduced a lot of boilerplate just for simple audio processing, and it wasn't very intuitive. And I knew that this was the easy part - UI would be even harder. However, it seemed there wasn't any alternative, so I just tried to stick with it. That's when I joined &quot;The Audio Programmer&quot;'s discord server, and an odd channel caught my attention - Cmajor it was named. I searched around a bit and eventually found <a href="https://cmajor.dev">cmajor.dev</a>, the official Cmajor website. So, what's this all about?</p>
<h2>A language for audio processing</h2>
<p>Cmajor is a domain specific language, that is, a language made specifically for audio processing. It can't really do anything else, but it can do audio <strong>really</strong> well. It has a simple syntax based on processors and graphs, which are exactly what you'd expect - processors process a signal, and graphs link processors together, in a way similar to block diagrams. All of this is extremely intuitive, and maps almost directly (at least for me) to the mental model of the effect. Further on, it�s a C-style language, so anyone who's done some programming can pick it up really quickly. Don't believe me? Then see it for yourself. Here's a simple Cmajor program, and I'm pretty sure you'll be able to understand it (as of now, there isn't syntax highlighting for Cmajor, but I'll try to fix that soon):</p>
<pre class="hljs"><code><table><tbody><tr><td class="line-number">1</td><td class="code-line">processor SineOscilattor [[ main ]]</td></tr><tr><td class="line-number">2</td><td class="code-line">{</td></tr><tr><td class="line-number">3</td><td class="code-line">    output stream <span class="hljs-type">float</span> out;</td></tr><tr><td class="line-number">4</td><td class="code-line"></td></tr><tr><td class="line-number">5</td><td class="code-line">    input value <span class="hljs-type">float</span> frequency [[ name: <span class="hljs-string">&quot;Frequency&quot;</span>, min: <span class="hljs-number">20.f</span>, max: <span class="hljs-number">20000.f</span>, init: <span class="hljs-number">440.f</span>, unit: <span class="hljs-string">&quot;Hz&quot;</span>]];</td></tr><tr><td class="line-number">6</td><td class="code-line">    input value <span class="hljs-type">float</span> amplitude [[ name: <span class="hljs-string">&quot;Amplitude&quot;</span>, min: <span class="hljs-number">0.f</span>, max: <span class="hljs-number">1.f</span>, init: <span class="hljs-number">0.2f</span>]];</td></tr><tr><td class="line-number">7</td><td class="code-line"></td></tr><tr><td class="line-number">8</td><td class="code-line">    <span class="hljs-type">float</span> phase = <span class="hljs-number">0</span>;</td></tr><tr><td class="line-number">9</td><td class="code-line">    </td></tr><tr><td class="line-number">10</td><td class="code-line"></td></tr><tr><td class="line-number">11</td><td class="code-line">    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>{ <span class="hljs-comment">//</span></td></tr><tr><td class="line-number">12</td><td class="code-line">        loop{</td></tr><tr><td class="line-number">13</td><td class="code-line">            out &lt;- <span class="hljs-function">amplitude * <span class="hljs-title">sin</span><span class="hljs-params">(phase)</span></span>;</td></tr><tr><td class="line-number">14</td><td class="code-line">            <span class="hljs-type">float</span> deltaPhase = <span class="hljs-built_in">float</span>(frequency * processor.period * twoPi);</td></tr><tr><td class="line-number">15</td><td class="code-line">            phase = <span class="hljs-built_in">addModulo2Pi</span>(phase, deltaPhase);</td></tr><tr><td class="line-number">16</td><td class="code-line">            <span class="hljs-built_in">advance</span>();</td></tr><tr><td class="line-number">17</td><td class="code-line">        }</td></tr><tr><td class="line-number">18</td><td class="code-line">    }</td></tr><tr><td class="line-number">19</td><td class="code-line">}</td></tr></tbody></table></code></pre>
<p>And here's how it looks (I'm loading it with the <a href="https://marketplace.visualstudio.com/items?itemName=SoundStacks.cmajor">vscode plugin</a>):</p>
<figure>
                <img src = "../images/posts/audio/cmajor-awesome_osc_gui.png" alt = " is generated by Cmajor based on the annotations provided in the program" style = "width:100%" />
                <figcaption><strong>This GUI</strong> is generated by Cmajor based on the annotations provided in the program</figcaption>
            </figure > <h2>Performance by default</h2>
<p>Cmajor is extremely efficient. Even without doing any fancy stuff, which we'll discuss later, it can match and often beat native C++ performance - without any effort! All this is achieved by a JIT compiler, which squeezes every little bit of performance it can from the target machine. But when coding, you don't need to even know this. You just code, and Cmajor does its magic to optimize your code. But that's not all it can do. Let's take a quick detour to graphics land.</p>
<h3>How graphics programming works</h3>
<p>Graphics programming usually involves a lot of computation-heavy tasks. Doing this on the CPU would be very inefficient, so engineers created a specialised device for graphics: the GPU. When targeting a GPU, you code shaders, which are basically programs that run on the graphics card. By doing this, you can benefit of massive parallelization, which is ideal for graphics programming. These shaders are written in either GLSL or HLSL, both being languages made specifically for GPUs. These languages are usually translated to a sort of &quot;GPU assembly&quot; by the drivers, and the resulting instructions are executed on the graphics card. The two main benefits of this approach are that it frees up the CPU to do other things and it offloads specialised work to a specialised worker.</p>
<p>So, why isn't this technique applied to other specialised tasks - like audio processing?</p>
<h3>Cmajor as an &quot;audio shader language&quot;</h3>
<p>Cmajor was created with the intent of being run on specialised units when they're available. You might be surprised to learn that most devices have these specialised units. They're called DSPs and are made for audio processing. However, unlike GPUs, most drivers don't allow programmers to run their own code on them, meaning they're hardly used. Cmajor's creators want to change this, and offset audio processing from the CPU to the DSP. Of course, this will require driver support, which will take a long time.</p>
<blockquote>
<p><strong>Disclaimer</strong>: technically speaking, this is speculation. What I describe here were the known goals of the creators of SOUL. It just so happens that the creators of SOUL are the creators of Cmajor, and the two languages look almost exactly the same. So, I think it's safe to say that the goals of SOUL and of Cmajor are also pretty similar. But don't take my word for it - there's no promise from the Cmajor team that this will ever be a reality. (On a side note, I couldn't really find out why SOUL was abandoned and then Cmajor was created, but if you know anything about this, I'd be really interested in hearing, so share your thoughts in the comments!)</p>
</blockquote>
<h2>Conclusion</h2>
<p>I sure think that Cmajor is pretty amazing, and I hope by now you agree with me. However, it doesn't get nearly as much attention as it deserves, which is a shame. Anyhow, let me know what you think in the comments, I'd really like to see some other points of view!</p>
<h3>Food for thought</h3>
<p>If you want to know more about Cmajor, I recommend you watch these two ADC talks:</p>
<ul>
<li><a href="https://youtu.be/qGVyaEVH0o0?si=jajUem0frUqbRPAr">SoundStacks' New Cmajor Platform</a></li>
<li><a href="https://youtu.be/-GhleKNaPdk?si=3AxPF6wRm9F1UoM_">SOUL Announcement - The First Universal Sound Language</a></li>
</ul>
<p>I've also been reading a book about DSP, so if you're into that kind of stuff, here it is: <a href="https://ccrma.stanford.edu/~jos/filters/filters.html">INTRODUCTION TO DIGITAL FILTERS</a> (it's very math heavy!)</p>
<p>That's all I have to say for now. Next time I'll be talking about a new project, which is the reason I've started learning audio programming in the first place, so keep your eyes peeled!</p>
</div></div></div><div class="newsletter-post"><form action="https://levimcgomes.pythonanywhere.com/newsletter_signup" method="POST">Subscribe to my newsletter to get notified about new posts!<div class="newsletter-form"><input type="email" name="email_address" placeholder="email address"/><input type="hidden" name="signup_page" value="https://levimcgomes.github.io/blog/audio_cmajor-awesome"/><input type="submit" class="btn" value="Sign up"/></div></form></div><div class="giscus"></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"frontmatter":{"title":"Cmajor is Awesome","date":"8/9/2023","cover_image":"images/posts/audio/cmajor-awesome_cover.png","tags":["audio","cmajor"],"excerpt":"Cmajor is a domain specific language for audio programming, and it is spectacular"},"slug":"audio_cmajor-awesome","content":"\nRecently, I've started learning about audio programming for a side project (more on this in the next post!). I started by trying to learn JUCE, but I found it awkward to work with, especially since C++ isn't my strongest language. It introduced a lot of boilerplate just for simple audio processing, and it wasn't very intuitive. And I knew that this was the easy part - UI would be even harder. However, it seemed there wasn't any alternative, so I just tried to stick with it. That's when I joined \"The Audio Programmer\"'s discord server, and an odd channel caught my attention - Cmajor it was named. I searched around a bit and eventually found [cmajor.dev](https://cmajor.dev), the official Cmajor website. So, what's this all about?\n\n## A language for audio processing\nCmajor is a domain specific language, that is, a language made specifically for audio processing. It can't really do anything else, but it can do audio **really** well. It has a simple syntax based on processors and graphs, which are exactly what you'd expect - processors process a signal, and graphs link processors together, in a way similar to block diagrams. All of this is extremely intuitive, and maps almost directly (at least for me) to the mental model of the effect. Further on, it�s a C-style language, so anyone who's done some programming can pick it up really quickly. Don't believe me? Then see it for yourself. Here's a simple Cmajor program, and I'm pretty sure you'll be able to understand it (as of now, there isn't syntax highlighting for Cmajor, but I'll try to fix that soon):\n\n```c++ showLineNumbers\nprocessor SineOscilattor [[ main ]]\n{\n    output stream float out;\n\n    input value float frequency [[ name: \"Frequency\", min: 20.f, max: 20000.f, init: 440.f, unit: \"Hz\"]];\n    input value float amplitude [[ name: \"Amplitude\", min: 0.f, max: 1.f, init: 0.2f]];\n\n    float phase = 0;\n    \n\n    void main(){ //\n        loop{\n            out \u003c- amplitude * sin(phase);\n            float deltaPhase = float(frequency * processor.period * twoPi);\n            phase = addModulo2Pi(phase, deltaPhase);\n            advance();\n        }\n    }\n}\n```\n\nAnd here's how it looks (I'm loading it with the [vscode plugin](https://marketplace.visualstudio.com/items?itemName=SoundStacks.cmajor)):\n\u0026\u0026\u0026img[images/posts/audio/cmajor-awesome_osc_gui.png](This GUI) is generated by Cmajor based on the annotations provided in the program\n\u0026\u0026\u0026\n\n## Performance by default\nCmajor is extremely efficient. Even without doing any fancy stuff, which we'll discuss later, it can match and often beat native C++ performance - without any effort! All this is achieved by a JIT compiler, which squeezes every little bit of performance it can from the target machine. But when coding, you don't need to even know this. You just code, and Cmajor does its magic to optimize your code. But that's not all it can do. Let's take a quick detour to graphics land.\n\n### How graphics programming works\nGraphics programming usually involves a lot of computation-heavy tasks. Doing this on the CPU would be very inefficient, so engineers created a specialised device for graphics: the GPU. When targeting a GPU, you code shaders, which are basically programs that run on the graphics card. By doing this, you can benefit of massive parallelization, which is ideal for graphics programming. These shaders are written in either GLSL or HLSL, both being languages made specifically for GPUs. These languages are usually translated to a sort of \"GPU assembly\" by the drivers, and the resulting instructions are executed on the graphics card. The two main benefits of this approach are that it frees up the CPU to do other things and it offloads specialised work to a specialised worker.\n\nSo, why isn't this technique applied to other specialised tasks - like audio processing?\n\n### Cmajor as an \"audio shader language\"\nCmajor was created with the intent of being run on specialised units when they're available. You might be surprised to learn that most devices have these specialised units. They're called DSPs and are made for audio processing. However, unlike GPUs, most drivers don't allow programmers to run their own code on them, meaning they're hardly used. Cmajor's creators want to change this, and offset audio processing from the CPU to the DSP. Of course, this will require driver support, which will take a long time.\n\n\u003e**Disclaimer**: technically speaking, this is speculation. What I describe here were the known goals of the creators of SOUL. It just so happens that the creators of SOUL are the creators of Cmajor, and the two languages look almost exactly the same. So, I think it's safe to say that the goals of SOUL and of Cmajor are also pretty similar. But don't take my word for it - there's no promise from the Cmajor team that this will ever be a reality. (On a side note, I couldn't really find out why SOUL was abandoned and then Cmajor was created, but if you know anything about this, I'd be really interested in hearing, so share your thoughts in the comments!)\n\n## Conclusion\nI sure think that Cmajor is pretty amazing, and I hope by now you agree with me. However, it doesn't get nearly as much attention as it deserves, which is a shame. Anyhow, let me know what you think in the comments, I'd really like to see some other points of view!\n\n### Food for thought\nIf you want to know more about Cmajor, I recommend you watch these two ADC talks:\n - [SoundStacks' New Cmajor Platform](https://youtu.be/qGVyaEVH0o0?si=jajUem0frUqbRPAr)\n - [SOUL Announcement - The First Universal Sound Language](https://youtu.be/-GhleKNaPdk?si=3AxPF6wRm9F1UoM_)\n\n I've also been reading a book about DSP, so if you're into that kind of stuff, here it is: [INTRODUCTION TO DIGITAL FILTERS](https://ccrma.stanford.edu/~jos/filters/filters.html) (it's very math heavy!)\n\n That's all I have to say for now. Next time I'll be talking about a new project, which is the reason I've started learning audio programming in the first place, so keep your eyes peeled!\n"},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"audio_cmajor-awesome"},"buildId":"yQWaVv-dGMBSVfk7VEAwv","assetPrefix":"https://cdn.statically.io/gh/levi-gomes/levi-gomes.github.io/gh-pages","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>